var nodes = [{"id":0,"label":"Abbot","group":"Basic","color":"#2E86AB","career":"Abbot","type":"Basic","role":"Academics"},{"id":1,"label":"Admiral","group":"Advanced","color":"#FE7F2D","career":"Admiral","type":"Advanced","role":"Warriors"},{"id":2,"label":"Agent of the Shroud","group":"Advanced","color":"#A23B72","career":"Agent of the Shroud","type":"Advanced","role":"Criminals"},{"id":3,"label":"Agitator","group":"Basic","color":"#EDDFCE","career":"Agitator","type":"Basic","role":"Commoners"},{"id":4,"label":"Ambassador","group":"Advanced","color":"#2E86AB","career":"Ambassador","type":"Advanced","role":"Academics"},{"id":5,"label":"Anchorite","group":"Basic","color":"#2E86AB","career":"Anchorite","type":"Basic","role":"Academics"},{"id":6,"label":"Animal Trainer","group":"Advanced","color":"#C5D86D","career":"Animal Trainer","type":"Advanced","role":"Rangers"},{"id":7,"label":"Anointed Priest","group":"Advanced","color":"#2E86AB","career":"Anointed Priest","type":"Advanced","role":"Academics"},{"id":8,"label":"Apothecary","group":"Basic","color":"#EDDFCE","career":"Apothecary","type":"Basic","role":"Commoners"},{"id":9,"label":"Apprentice Runesmith","group":"Basic","color":"#EDDFCE","career":"Apprentice Runesmith","type":"Basic","role":"Commoners"},{"id":10,"label":"Apprentice Witch","group":"Basic","color":"#2E86AB","career":"Apprentice Witch","type":"Basic","role":"Academics"},{"id":11,"label":"Apprentice Wizard","group":"Basic","color":"#2E86AB","career":"Apprentice Wizard","type":"Basic","role":"Academics"},{"id":12,"label":"Artillerist","group":"Advanced","color":"#FE7F2D","career":"Artillerist","type":"Advanced","role":"Warriors"},{"id":13,"label":"Artisan","group":"Advanced","color":"#EDDFCE","career":"Artisan","type":"Advanced","role":"Commoners"},{"id":14,"label":"Assassin","group":"Advanced","color":"#A23B72","career":"Assassin","type":"Advanced","role":"Criminals"},{"id":15,"label":"Astrologer","group":"Advanced","color":"#2E86AB","career":"Astrologer","type":"Advanced","role":"Academics"},{"id":16,"label":"Ataman","group":"Advanced","color":"#2E86AB","career":"Ataman","type":"Advanced","role":"Academics"},{"id":17,"label":"Badlander","group":"Basic","color":"#C5D86D","career":"Badlander","type":"Basic","role":"Rangers"},{"id":18,"label":"Badlands Rangers","group":"Advanced","color":"#C5D86D","career":"Badlands Rangers","type":"Advanced","role":"Rangers"},{"id":19,"label":"Bailiff","group":"Basic","color":"#FE7F2D","career":"Bailiff","type":"Basic","role":"Warriors"},{"id":20,"label":"Barber-Surgeon","group":"Basic","color":"#EDDFCE","career":"Barber-Surgeon","type":"Basic","role":"Commoners"},{"id":21,"label":"Battle Pilgrim","group":"Advanced","color":"#FE7F2D","career":"Battle Pilgrim","type":"Advanced","role":"Warriors"},{"id":22,"label":"Bear Tamer","group":"Basic","color":"#EDDFCE","career":"Bear Tamer","type":"Basic","role":"Commoners"},{"id":23,"label":"Black Guard","group":"Advanced","color":"#FE7F2D","career":"Black Guard","type":"Advanced","role":"Warriors"},{"id":24,"label":"Boatman","group":"Basic","color":"#EDDFCE","career":"Boatman","type":"Basic","role":"Commoners"},{"id":25,"label":"Bodyguard","group":"Basic","color":"#FE7F2D","career":"Bodyguard","type":"Basic","role":"Warriors"},{"id":26,"label":"Bondsman","group":"Basic","color":"#FE7F2D","career":"Bondsman","type":"Basic","role":"Warriors"},{"id":27,"label":"Bonepicker","group":"Basic","color":"#EDDFCE","career":"Bonepicker","type":"Basic","role":"Commoners"},{"id":28,"label":"Border Courtier","group":"Advanced","color":"#A23B72","career":"Border Courtier","type":"Advanced","role":"Criminals"},{"id":29,"label":"Bounty Hunter","group":"Basic","color":"#FE7F2D","career":"Bounty Hunter","type":"Basic","role":"Warriors"},{"id":30,"label":"Burgher","group":"Basic","color":"#EDDFCE","career":"Burgher","type":"Basic","role":"Commoners"},{"id":31,"label":"Cated","group":"Basic","color":"#FE7F2D","career":"Cated","type":"Basic","role":"Warriors"},{"id":32,"label":"Camp Follower","group":"Basic","color":"#EDDFCE","career":"Camp Follower","type":"Basic","role":"Commoners"},{"id":33,"label":"Cantor","group":"Advanced","color":"#2E86AB","career":"Cantor","type":"Advanced","role":"Academics"},{"id":34,"label":"Captain","group":"Advanced","color":"#FE7F2D","career":"Captain","type":"Advanced","role":"Warriors"},{"id":35,"label":"Carcassonne Shepherd","group":"Basic","color":"#EDDFCE","career":"Carcassonne Shepherd","type":"Basic","role":"Commoners"},{"id":36,"label":"Cartographer","group":"Basic","color":"#EDDFCE","career":"Cartographer","type":"Basic","role":"Commoners"},{"id":37,"label":"Cat Burglar","group":"Advanced","color":"#A23B72","career":"Cat Burglar","type":"Advanced","role":"Criminals"},{"id":38,"label":"Catechist","group":"Advanced","color":"#2E86AB","career":"Catechist","type":"Advanced","role":"Academics"},{"id":39,"label":"Cenobite","group":"Basic","color":"#2E86AB","career":"Cenobite","type":"Basic","role":"Academics"},{"id":40,"label":"Champion","group":"Advanced","color":"#FE7F2D","career":"Champion","type":"Advanced","role":"Warriors"},{"id":41,"label":"Charcoal Burner","group":"Basic","color":"#C5D86D","career":"Charcoal Burner","type":"Basic","role":"Rangers"},{"id":42,"label":"Charlatan","group":"Advanced","color":"#A23B72","career":"Charlatan","type":"Advanced","role":"Criminals"},{"id":43,"label":"Chekist","group":"Basic","color":"#FE7F2D","career":"Chekist","type":"Basic","role":"Warriors"},{"id":44,"label":"Chimneysweep","group":"Basic","color":"#EDDFCE","career":"Chimneysweep","type":"Basic","role":"Commoners"},{"id":45,"label":"Cloaked Brother","group":"Advanced","color":"#A23B72","career":"Cloaked Brother","type":"Advanced","role":"Criminals"},{"id":46,"label":"Coachman","group":"Basic","color":"#C5D86D","career":"Coachman","type":"Basic","role":"Rangers"},{"id":47,"label":"Courtier","group":"Advanced","color":"#2E86AB","career":"Courtier","type":"Advanced","role":"Academics"},{"id":48,"label":"Crime Lord","group":"Advanced","color":"#A23B72","career":"Crime Lord","type":"Advanced","role":"Criminals"},{"id":49,"label":"Crusader","group":"Advanced","color":"#FE7F2D","career":"Crusader","type":"Advanced","role":"Warriors"},{"id":50,"label":"Cult Attendant","group":"Advanced","color":"#2E86AB","career":"Cult Attendant","type":"Advanced","role":"Academics"},{"id":51,"label":"Daemon Slayer","group":"Advanced","color":"#FE7F2D","career":"Daemon Slayer","type":"Advanced","role":"Warriors"},{"id":52,"label":"Deepwatcher","group":"Basic","color":"#C5D86D","career":"Deepwatcher","type":"Basic","role":"Rangers"},{"id":53,"label":"Demagogue","group":"Advanced","color":"#2E86AB","career":"Demagogue","type":"Advanced","role":"Academics"},{"id":54,"label":"Dilettante","group":"Basic","color":"#2E86AB","career":"Dilettante","type":"Basic","role":"Academics"},{"id":55,"label":"Drover","group":"Basic","color":"#C5D86D","career":"Drover","type":"Basic","role":"Rangers"},{"id":56,"label":"Duellist","group":"Advanced","color":"#FE7F2D","career":"Duellist","type":"Advanced","role":"Warriors"},{"id":57,"label":"Dung Collector","group":"Basic","color":"#EDDFCE","career":"Dung Collector","type":"Basic","role":"Commoners"},{"id":58,"label":"Embalmer","group":"Basic","color":"#2E86AB","career":"Embalmer","type":"Basic","role":"Academics"},{"id":59,"label":"Enforcer","group":"Advanced","color":"#C5D86D","career":"Enforcer","type":"Advanced","role":"Rangers"},{"id":60,"label":"Engineer","group":"Advanced","color":"#EDDFCE","career":"Engineer","type":"Advanced","role":"Commoners"},{"id":61,"label":"Entertainer","group":"Basic","color":"#EDDFCE","career":"Entertainer","type":"Basic","role":"Commoners"},{"id":62,"label":"Envoy","group":"Basic","color":"#2E86AB","career":"Envoy","type":"Basic","role":"Academics"},{"id":63,"label":"Estalian Diestro","group":"Basic","color":"#FE7F2D","career":"Estalian Diestro","type":"Basic","role":"Warriors"},{"id":64,"label":"Ex-Convict","group":"Basic","color":"#A23B72","career":"Ex-Convict","type":"Basic","role":"Criminals"},{"id":65,"label":"Exciseman","group":"Basic","color":"#EDDFCE","career":"Exciseman","type":"Basic","role":"Commoners"},{"id":66,"label":"Exorcist","group":"Advanced","color":"#2E86AB","career":"Exorcist","type":"Advanced","role":"Academics"},{"id":67,"label":"Explorer","group":"Advanced","color":"#C5D86D","career":"Explorer","type":"Advanced","role":"Rangers"},{"id":68,"label":"Faceless","group":"Advanced","color":"#A23B72","career":"Faceless","type":"Advanced","role":"Criminals"},{"id":69,"label":"Farmer","group":"Basic","color":"#EDDFCE","career":"Farmer","type":"Basic","role":"Commoners"},{"id":70,"label":"Fence","group":"Advanced","color":"#A23B72","career":"Fence","type":"Advanced","role":"Criminals"},{"id":71,"label":"Ferryman","group":"Basic","color":"#C5D86D","career":"Ferryman","type":"Basic","role":"Rangers"},{"id":72,"label":"Fieldwarden","group":"Basic","color":"#C5D86D","career":"Fieldwarden","type":"Basic","role":"Rangers"},{"id":73,"label":"Fisherman","group":"Basic","color":"#EDDFCE","career":"Fisherman","type":"Basic","role":"Commoners"},{"id":74,"label":"Flagellant","group":"Advanced","color":"#2E86AB","career":"Flagellant","type":"Advanced","role":"Academics"},{"id":75,"label":"Foreman","group":"Advanced","color":"#EDDFCE","career":"Foreman","type":"Advanced","role":"Commoners"},{"id":76,"label":"Forger","group":"Advanced","color":"#A23B72","career":"Forger","type":"Advanced","role":"Criminals"},{"id":77,"label":"Freeholder","group":"Basic","color":"#EDDFCE","career":"Freeholder","type":"Basic","role":"Commoners"},{"id":78,"label":"Friar","group":"Advanced","color":"#2E86AB","career":"Friar","type":"Advanced","role":"Academics"},{"id":79,"label":"Frogwife","group":"Basic","color":"#EDDFCE","career":"Frogwife","type":"Basic","role":"Commoners"},{"id":80,"label":"Gambler","group":"Basic","color":"#A23B72","career":"Gambler","type":"Basic","role":"Criminals"},{"id":81,"label":"Ghost Strider","group":"Advanced","color":"#C5D86D","career":"Ghost Strider","type":"Advanced","role":"Rangers"},{"id":82,"label":"Giant Slayer","group":"Advanced","color":"#FE7F2D","career":"Giant Slayer","type":"Advanced","role":"Warriors"},{"id":83,"label":"Grail Knight","group":"Advanced","color":"#FE7F2D","career":"Grail Knight","type":"Advanced","role":"Warriors"},{"id":84,"label":"Grail Pilgrim","group":"Basic","color":"#FE7F2D","career":"Grail Pilgrim","type":"Basic","role":"Warriors"}]

var edges = [{"from":7,"to":53,"weight":1,"id":"7--53"},{"from":38,"to":78,"weight":1,"id":"38--78"},{"from":54,"to":42,"weight":1,"id":"54--42"},{"from":3,"to":42,"weight":1,"id":"3--42"},{"from":13,"to":53,"weight":1,"id":"13--53"},{"from":46,"to":71,"weight":1,"id":"46--71"},{"from":76,"to":42,"weight":1,"id":"76--42"},{"from":34,"to":3,"weight":1,"id":"34--3"},{"from":5,"to":17,"weight":1,"id":"5--17"},{"from":23,"to":34,"weight":1,"id":"23--34"},{"from":67,"to":34,"weight":1,"id":"67--34"},{"from":1,"to":67,"weight":1,"id":"1--67"},{"from":68,"to":53,"weight":1,"id":"68--53"},{"from":28,"to":34,"weight":1,"id":"28--34"},{"from":45,"to":14,"weight":1,"id":"45--14"},{"from":72,"to":29,"weight":1,"id":"72--29"},{"from":54,"to":11,"weight":1,"id":"54--11"},{"from":30,"to":3,"weight":1,"id":"30--3"},{"from":30,"to":70,"weight":1,"id":"30--70"},{"from":53,"to":78,"weight":1,"id":"53--78"},{"from":18,"to":34,"weight":1,"id":"18--34"},{"from":66,"to":7,"weight":1,"id":"66--7"},{"from":70,"to":42,"weight":1,"id":"70--42"},{"from":27,"to":37,"weight":1,"id":"27--37"},{"from":80,"to":42,"weight":1,"id":"80--42"},{"from":6,"to":61,"weight":1,"id":"6--61"},{"from":58,"to":30,"weight":1,"id":"58--30"},{"from":56,"to":40,"weight":1,"id":"56--40"},{"from":54,"to":15,"weight":1,"id":"54--15"},{"from":4,"to":34,"weight":1,"id":"4--34"},{"from":37,"to":70,"weight":1,"id":"37--70"},{"from":46,"to":36,"weight":1,"id":"46--36"},{"from":81,"to":34,"weight":1,"id":"81--34"},{"from":45,"to":53,"weight":1,"id":"45--53"},{"from":35,"to":84,"weight":1,"id":"35--84"},{"from":54,"to":38,"weight":1,"id":"54--38"},{"from":77,"to":13,"weight":1,"id":"77--13"},{"from":21,"to":68,"weight":1,"id":"21--68"},{"from":13,"to":60,"weight":1,"id":"13--60"},{"from":8,"to":20,"weight":1,"id":"8--20"},{"from":47,"to":56,"weight":1,"id":"47--56"},{"from":52,"to":67,"weight":1,"id":"52--67"},{"from":80,"to":53,"weight":1,"id":"80--53"},{"from":26,"to":77,"weight":1,"id":"26--77"},{"from":33,"to":61,"weight":1,"id":"33--61"},{"from":78,"to":53,"weight":1,"id":"78--53"},{"from":8,"to":13,"weight":1,"id":"8--13"},{"from":36,"to":67,"weight":1,"id":"36--67"},{"from":82,"to":51,"weight":1,"id":"82--51"},{"from":70,"to":48,"weight":1,"id":"70--48"},{"from":1,"to":4,"weight":1,"id":"1--4"},{"from":3,"to":53,"weight":1,"id":"3--53"},{"from":23,"to":40,"weight":1,"id":"23--40"},{"from":36,"to":13,"weight":1,"id":"36--13"},{"from":60,"to":13,"weight":1,"id":"60--13"},{"from":60,"to":67,"weight":1,"id":"60--67"},{"from":54,"to":47,"weight":1,"id":"54--47"},{"from":80,"to":61,"weight":1,"id":"80--61"},{"from":75,"to":53,"weight":1,"id":"75--53"},{"from":25,"to":19,"weight":1,"id":"25--19"},{"from":83,"to":34,"weight":1,"id":"83--34"},{"from":79,"to":32,"weight":1,"id":"79--32"},{"from":3,"to":64,"weight":1,"id":"3--64"},{"from":83,"to":67,"weight":1,"id":"83--67"},{"from":68,"to":48,"weight":1,"id":"68--48"},{"from":17,"to":37,"weight":1,"id":"17--37"},{"from":28,"to":47,"weight":1,"id":"28--47"},{"from":33,"to":38,"weight":1,"id":"33--38"},{"from":78,"to":74,"weight":1,"id":"78--74"},{"from":37,"to":48,"weight":1,"id":"37--48"},{"from":7,"to":74,"weight":1,"id":"7--74"},{"from":44,"to":37,"weight":1,"id":"44--37"},{"from":49,"to":67,"weight":1,"id":"49--67"},{"from":63,"to":56,"weight":1,"id":"63--56"},{"from":18,"to":67,"weight":1,"id":"18--67"},{"from":84,"to":21,"weight":1,"id":"84--21"},{"from":83,"to":47,"weight":1,"id":"83--47"},{"from":79,"to":24,"weight":1,"id":"79--24"},{"from":65,"to":3,"weight":1,"id":"65--3"},{"from":24,"to":73,"weight":1,"id":"24--73"},{"from":34,"to":67,"weight":1,"id":"34--67"},{"from":53,"to":48,"weight":1,"id":"53--48"},{"from":49,"to":34,"weight":1,"id":"49--34"},{"from":45,"to":48,"weight":1,"id":"45--48"},{"from":64,"to":37,"weight":1,"id":"64--37"},{"from":14,"to":40,"weight":1,"id":"14--40"},{"from":6,"to":22,"weight":1,"id":"6--22"},{"from":28,"to":14,"weight":1,"id":"28--14"},{"from":32,"to":42,"weight":1,"id":"32--42"},{"from":75,"to":70,"weight":1,"id":"75--70"},{"from":40,"to":14,"weight":1,"id":"40--14"},{"from":71,"to":24,"weight":1,"id":"71--24"},{"from":25,"to":29,"weight":1,"id":"25--29"},{"from":47,"to":42,"weight":1,"id":"47--42"},{"from":74,"to":53,"weight":1,"id":"74--53"},{"from":84,"to":35,"weight":1,"id":"84--35"},{"from":76,"to":13,"weight":1,"id":"76--13"},{"from":63,"to":25,"weight":1,"id":"63--25"},{"from":15,"to":67,"weight":1,"id":"15--67"},{"from":26,"to":25,"weight":1,"id":"26--25"},{"from":15,"to":11,"weight":1,"id":"15--11"},{"from":42,"to":37,"weight":1,"id":"42--37"},{"from":15,"to":42,"weight":1,"id":"15--42"},{"from":64,"to":70,"weight":1,"id":"64--70"},{"from":76,"to":70,"weight":1,"id":"76--70"},{"from":27,"to":70,"weight":1,"id":"27--70"},{"from":48,"to":53,"weight":1,"id":"48--53"},{"from":58,"to":11,"weight":1,"id":"58--11"},{"from":8,"to":11,"weight":1,"id":"8--11"},{"from":42,"to":53,"weight":1,"id":"42--53"},{"from":36,"to":76,"weight":1,"id":"36--76"},{"from":64,"to":42,"weight":1,"id":"64--42"},{"from":22,"to":61,"weight":1,"id":"22--61"},{"from":38,"to":53,"weight":1,"id":"38--53"},{"from":62,"to":42,"weight":1,"id":"62--42"},{"from":83,"to":68,"weight":1,"id":"83--68"},{"from":12,"to":13,"weight":1,"id":"12--13"},{"from":52,"to":60,"weight":1,"id":"52--60"},{"from":22,"to":6,"weight":1,"id":"22--6"},{"from":61,"to":42,"weight":1,"id":"61--42"},{"from":56,"to":14,"weight":1,"id":"56--14"},{"from":45,"to":42,"weight":1,"id":"45--42"},{"from":8,"to":58,"weight":1,"id":"8--58"},{"from":68,"to":67,"weight":1,"id":"68--67"},{"from":61,"to":6,"weight":1,"id":"61--6"}]

// used to restore original state after modification
var backup_nodes = new vis.DataSet(nodes)
var dataset = {
    nodes: new vis.DataSet(nodes),
    edges: new vis.DataSet(edges)
}
var options = {
    nodes: {
        shadow: false,
        chosen: {
            node: function(values, id, selected, hovering) {
                values.size = values.size * 1.66;
                values.borderColor = '#1e2426';
                values.borderWidth = 4;
                values.shadow = true;
            }} 
    },
    edges: {
        arrows: {
            to: true,
            middle: false
        },
        arrowStrikethrough: false,
        color: '#aaa',
        dashes: true,
        chosen: {
            edge: function(values, id, selected, hovering) {
                values.width = 3;
                values.color = '#555555';
                values.dashes = false;
            }
        }
    },
    interaction: {
        selectConnectedEdges: true,
        multiselect: true,
        hover: true
    },
    groups: {
        Basic: {
            shape: 'dot',
            color: {
                border: 'black'
            }
        },
        Advanced: {
            shape: 'diamond',
            borderWidth: 4,
            color: {
                border: 'gold'
            },
            size: 35
        }
    }
}
var container = document.getElementById('widget')
var pathdisplay = document.getElementById('pathdisplay')
var selectedNodes = []

var network = new vis.Network(container, dataset, options)
network.on('stabilized', function() {
    network.setOptions({
        nodes: {physics: false}
    })
})
network.on('selectNode', function(e) {
    e.nodes.forEach(node => {
        if (!selectedNodes.includes(node)) 
            selectedNodes.push(node)
    })
    if (selectedNodes.length > 1) {
        findPath(selectedNodes[0], selectedNodes[selectedNodes.length - 1])
    }
})
network.on('deselectNode', function(e) {
    if (e.nodes.length < 2) {
        selectedNodes = e.nodes
    } else {
        selectedNodes.forEach(node => {
            if (!e.nodes.includes(node)) {
                selectedNodes.splice(selectedNodes.indexOf(node), 1)
            }
        })
    }
})

var careers = nodes.map(node => node.label)
var careerIndex = {}
nodes.forEach(node => careerIndex[node.label] = node.id)
var graph = new GraphFactory().createDirectedGraph(careers, edges)
var searcher = new GraphSearcher(graph)

function findPath(start, target) {
    var pathStrings = {
        path: 'The fastest path for your selection is: ',
        nopath: 'There is no career path between the chosen career options. :('
    }
    var path = searcher.getPath(start, target, directed = false).reverse()
    network.selectNodes(path, true)
    network.fit({nodes: path, animation: true})
    if (path.length > 0) {
        var pathCareers = path.map(id => careers[id])
        pathdisplay.innerText = pathStrings.path + pathCareers
    } else {
        pathdisplay.innerText = pathStrings.nopath
        selectedNodes.pop()
        network.unselectAll()
        network.selectNodes(selectedNodes, true)
    }
}